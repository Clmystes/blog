---
title: macOS 中的惯性滚动
date: 2020-10-12
---

滚动页面是一个十分常见的操作，而如果你同时是 windows 与 macOS 的用户，一定会发现
macOS 中的滚动是带有惯性的，windows 中则没有。

造成这种交互区别的原因是两者输入设备的不同，windows 下主要使用鼠标滚轮进行滚动操作，
而滚轮本身就带有无限滚动的特性，因此在长页面下滚动的交互是很自然的。而 macOS 一般的滚动输入设备
是 Trackpad 和 MagicMouse，滚动的触发类似手机，需要手指触摸滑动，由于触摸面积有限，在长页面下如果
想进行连续的滚动操作，必须将手指抬起并返回到触摸板起始位置重新滚动。因此针对这类场景，苹果在系统级别
做出了优化：使滚动带有惯性。这样整个滚动的手势，就像是拨动一个珠子一样，拨的速度越快滚动的距离越长，滚动过程中再次触摸
相当于停下了珠子，滚动的行为也随之停止。

当然这个惯性行为也是可以关闭的。

![0RQ1Gq.png](https://s1.ax1x.com/2020/10/12/0RQ1Gq.png)

## 如何使用 JS 判断“惯性滚动”与“正常滚动”

有一种常见的交互效果，每次滚动整个页面就向下滚动一整屏，比如[无锋科技官网](https://www.wufeng.com/)。
但是在 macOS 中由于惯性滚动的存在，使用触摸板或 MM 时，每次滚动由于惯性会触发多次页面的切换。这时候就需要使用
JS 控制仅在用户主动触发的滚动时才切换页面。很明显，这类平台特定的 API，浏览器并不会提供给你。
`wheelDelta` 是滚动事件提供给我们的回调数据，我们可以理解为滚动距离，使用这个数据我们绘制出不同情况下的滚动距离变化图表。

![0f7lh6.png](https://s1.ax1x.com/2020/10/13/0f7lh6.png)
![0f7u7R.png](https://s1.ax1x.com/2020/10/13/0f7u7R.png)

(数据来自 https://github.com/d4nyll/lethargy)

我们可以发现，如果 `wheelDelta` 一直在衰减，就证明这是一次滚性滚动。逻辑很简单，具体代码逻辑可以看 [lethargy](https://github.com/d4nyll/lethargy)
的实现（也可以了解下其中的限制）。
